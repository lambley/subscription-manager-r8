<div class="w-full bg-gray-200 p-6 rounded mb-8" data-controller="subscription">
  <h2 class="text-2xl font-semibold mb-4">Summary</h2>
  <div class="overflow-x-auto">
    <table class="min-w-full border-collapse table-auto md:table-fixed">
      <thead>
        <tr class="bg-gray-300">
          <th class="text-left p-2 border-r border-gray-400 w-1/4">Type</th>
          <th class="text-left p-2 border-r border-gray-400 w-1/4">Actual</th>
          <th class="text-left p-2 w-1/2">Budget</th>
        </tr>
      </thead>
      <tbody>
        <tr class="bg-white">
          <td class="p-2 border-r border-gray-300">Monthly</td>
          <td class="p-2 border-r border-gray-300"><%= number_to_currency(total_cost(subscriptions, "monthly")) %></td>
          <td class="p-2 border-r border-gray-300 flex items-center space-x-2">
            <% if Current.user.budget.present? %>
              <span id="monthly-budget-display" data-subscription-target="monthlyBudgetDisplay" class="w-full"><%= number_to_currency(Current.user.budget / 12) %></span>
              <input type="text" id="monthly-budget-input" data-subscription-target="monthlyBudgetInput" class="border rounded p-2 hidden w-full" value="<%= Current.user.budget / 12 %>" data-action="keydown->subscription#handleKeydown">
            <% else %>
              <span id="monthly-budget-display" data-subscription-target="monthlyBudgetDisplay" class="w-full text-red-500">Budget not set</span>
              <input type="text" id="monthly-budget-input" data-subscription-target="monthlyBudgetInput" class="border rounded p-2 hidden w-full" placeholder="Set your budget" data-action="keydown->subscription#handleKeydown">
            <% end %>
            <%= render_button(
              text: 'Edit',
              icon: 'fa-regular fa-pen-to-square',
              link: '#',
              button_type: 'link_to',
              data: {
                controller: 'subscription',
                action: 'click->subscription#toggleMonthlyBudgetEdit',
                target: 'editMonthlyButton'
              },
              bg_class: 'bg-blue-500 text-white',
              id: 'edit-monthly-budget',
            ) %>
            <%= render_button(
              text: 'Save',
              icon: 'fa-regular fa-floppy-disk',
              link: '#',
              button_type: 'link_to',
              data: {
                controller: 'subscription',
                action: 'click->subscription#saveMonthlyBudget',
                target: 'saveMonthlyButton'
              },
              bg_class: 'bg-green-500 text-white',
              class: 'hidden',
              id: 'save-monthly-budget'
            ) %>
            <%= render_button(
              text: 'Cancel',
              icon: 'fa-solid fa-xmark',
              link: '#',
              button_type: 'link_to',
              data: {
                controller: 'subscription',
                action: 'click->subscription#toggleMonthlyBudgetEdit',
                target: 'cancelMonthlyButton'
              },
              bg_class: 'bg-gray-500 text-white',
              class: 'hidden',
              id: 'cancel-monthly-budget'
            ) %>
          </td>
        </tr>
        <tr class="bg-white">
          <td class="p-2 border-r border-gray-300">Annual</td>
          <td class="p-2 border-r border-gray-300"><%= number_to_currency(total_cost(subscriptions, "annual")) %></td>
          <td class="p-2 border-r border-gray-300 flex items-center space-x-2">
            <% if Current.user.budget.present? %>
              <span id="annual-budget-display" data-subscription-target="annualBudgetDisplay" class="w-full"><%= number_to_currency(Current.user.budget) %></span>
              <input type="text" id="annual-budget-input" data-subscription-target="annualBudgetInput" class="border rounded p-2 hidden w-full" value="<%= Current.user.budget %>" data-action="keydown->subscription#handleKeydown">
            <% else %>
              <span id="annual-budget-display" data-subscription-target="annualBudgetDisplay" class="w-full text-red-500">Budget not set</span>
              <input type="text" id="annual-budget-input" data-subscription-target="annualBudgetInput" class="border rounded p-2 hidden w-full" placeholder="Set your budget" data-action="keydown->subscription#handleKeydown">
            <% end %>
            <%= render_button(
              text: 'Edit',
              icon: 'fa-regular fa-pen-to-square',
              link: '#',
              button_type: 'link_to',
              data: {
                controller: 'subscription',
                action: 'click->subscription#toggleAnnualBudgetEdit',
                target: 'editAnnualButton'
              },
              bg_class: 'bg-blue-500 text-white',
              id: 'edit-annual-budget',
            ) %>
            <%= render_button(
              text: 'Save',
              icon: 'fa-regular fa-floppy-disk',
              link: '#',
              button_type: 'link_to',
              data: {
                controller: 'subscription',
                action: 'click->subscription#saveAnnualBudgetEdit',
                target: 'saveAnnualButton'
              },
              bg_class: 'bg-green-500 text-white0',
              id: 'save-annual-budget',
              class: 'hidden'
            ) %>
            <%= render_button(
              text: 'Cancel',
              icon: 'fa-solid fa-xmark',
              link: '#',
              button_type: 'link_to',
              data: {
                controller: 'subscription',
                action: 'click->subscription#toggleAnnualBudgetEdit',
                target: 'cancelAnnualButton'
              },
              bg_class: 'bg-gray-500 text-white',
              id: 'cancel-annual-budget',
              class: 'hidden'
            ) %>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
